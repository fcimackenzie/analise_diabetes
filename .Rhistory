#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- survey::svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026 = as.character(diab_estados.df$v0026)
diab_estados.df$v0026[diab_estados.df$v0026 == 1]  = "1 - Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == 2]  = "2 - Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq/1000, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq/1000, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- as.data.frame(survey::svytable(~ v0001 + q030 , pns_design_srvyr))
qtd_estados = aggregate(diab_estados$Freq, by=list(Category=diab_estados$v0001), FUN=sum)
diab_estados <- diab_estados[diab_estados$q030 == 1,]
diab_estados$Porcent <- diab_estados$Freq / qtd_estados$x
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
porc_est <- as.data.frame(teste)
porc_est$Porcent <- diab_estados$Porcent
##
##uf_map <- get_brmap("State") %>%
#  inner_join(porc_est, c("nome" = "teste"))
#uf_map %>%
#  ggplot(aes(fill = Porcent)) +
#  geom_sf() +
#  scale_fill_continuous(low = "lightblue", high = "darkblue")
plot_brmap(get_brmap("State"), data_to_join = porc_est, join_by = c("nome" = "teste"),
var = "Porcent") + scale_fill_continuous(low = "lightblue", high = "darkblue")
survey::svyhist(~as.numeric(q031), subset(pns_design_srvyr, q030==1))
dens <- survey::svysmooth(~as.numeric(q031), subset(pns_design_srvyr, (q030==1) & (q030!=" ")))
lines(dens,col="blue",lwd=2)
survey::svyboxplot(r043 ~ q030, subset(pns_design_srvyr, c006 == "feminino"), all.outliers=TRUE)
perda_t <- as.data.frame(survey::svytable(~pressao_alta_q002 + colesterol_alto_q060 + diagnostico_diabetes_q030 , df))
print(paste0("quantidade total de diabéticos: ", sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1, c("Freq")])) )
print(paste0("perda de diabéticos: ", sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1 & (perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " "), c("Freq")])) )
print(paste0("porcentagem de perda de diabeticos: ", sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1 & (perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " "), c("Freq")]) / sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1, c("Freq")])  ))
print("")
print(paste0("quantidade total : ", sum(perda_t$Freq)))
print(paste0("perda total: ", sum(perda_t[ (perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " " | perda_t$diagnostico_diabetes_q030 == " "), c("Freq")])) )
print(paste0("porcentagem de perda total: ", sum(perda_t[(perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " " | perda_t$diagnostico_diabetes_q030 == " "), c("Freq")]) / sum(perda_t$Freq)))
knitr::opts_chunk$set(echo = TRUE)
library(srvyr)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(knitr)
library(tidyr)
perda_t <- as.data.frame(survey::svytable(~pressao_alta_q002 + colesterol_alto_q060 + diagnostico_diabetes_q030 , df))
print(paste0("quantidade total de diabéticos: ", sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1, c("Freq")])) )
print(paste0("perda de diabéticos: ", sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1 & (perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " "), c("Freq")])) )
print(paste0("porcentagem de perda de diabeticos: ", sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1 & (perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " "), c("Freq")]) / sum(perda_t[perda_t$diagnostico_diabetes_q030 == 1, c("Freq")])  ))
print("")
print(paste0("quantidade total : ", sum(perda_t$Freq)))
print(paste0("perda total: ", sum(perda_t[ (perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " " | perda_t$diagnostico_diabetes_q030 == " "), c("Freq")])) )
print(paste0("porcentagem de perda total: ", sum(perda_t[(perda_t$pressao_alta_q002 == " " | perda_t$colesterol_alto_q060 == " " | perda_t$diagnostico_diabetes_q030 == " "), c("Freq")]) / sum(perda_t$Freq)))
survey::summary(svyglm(diagnostico_diabetes_q030, design=df))
summary(survey::svyglm(diagnostico_diabetes_q030, design=df))
View(df)
summary(survey::svyglm(diagnostico_diabetes_q030~, design=df))
survey::svyglm(diagnostico_diabetes_q030, design=df)
gl1 <- survey::svyglm(diagnostico_diabetes_q030 ~ escolaridade_d009, design=df)
View(df$variables)
install.packages("dummies")
install.packages("dummies")
install.packages("Rtools")
install.packages("dummies")
library(dummies)
dummies::dummy.data.frame(df$variables)
a <- dummies::dummy.data.frame(df$variables)
View(a)
a <- dummies::dummy(df$variables)
a <- dummies::dummy(df$variables$diagnostico_diabetes_q030)
a <- dummies::dummy(df$variables)
a <- dummies::dummy(sep = "_", x = df$variables)
a <- dummies::dummy(df$variables$diagnostico_diabetes_q030, sep = "_",)
View(a)
a <- subset(df, diagnostico_diabetes_q030 != "")
View(df$prob)
a <- subset(df, diagnostico_diabetes_q030 != "" & diagnostico_diabetes_q030 != 2)
View(a)
View(a$prob)
a <- subset(df, diagnostico_diabetes_q030 != "" & diagnostico_diabetes_q030 != 2)
# q030 variável de diagnostico de diabetes
tir <- survey::svytable(~ diagnostico_diabetes_q030, a)
tir.df <- as.data.frame(tir)
tir.df$q030 <- c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
tir.df$Freq <- tir.df$Freq / sum(tir.df$Freq)
p <-ggplot(data=tir.df, aes(x=diagnostico_diabetes_q030, y=Freq*100, fill = diagnostico_diabetes_q030)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
a <- subset(df, diagnostico_diabetes_q030 != " " & diagnostico_diabetes_q030 != 2)
# q030 variável de diagnostico de diabetes
tir <- survey::svytable(~ diagnostico_diabetes_q030, a)
tir.df <- as.data.frame(tir)
tir.df$q030 <- c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
tir.df$Freq <- tir.df$Freq / sum(tir.df$Freq)
p <-ggplot(data=tir.df, aes(x=diagnostico_diabetes_q030, y=Freq*100, fill = diagnostico_diabetes_q030)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
a <- subset(df, diagnostico_diabetes_q030 != " " & diagnostico_diabetes_q030 != 2 & perda_t$pressao_alta_q002 != " " & colesterol_alto_q060 != " ")
a <- subset(df, diagnostico_diabetes_q030 != " " & diagnostico_diabetes_q030 != 2 & perda_t$pressao_alta_q002 != " " & colesterol_alto_q060 != " ")
a <- subset(df, diagnostico_diabetes_q030 != " " & diagnostico_diabetes_q030 != 2 & pressao_alta_q002 != " " & colesterol_alto_q060 != " ")
View(a)
df <- subset(df, diagnostico_diabetes_q030 != " " & diagnostico_diabetes_q030 != 2 & pressao_alta_q002 != " " & colesterol_alto_q060 != " ")
# Criando as variáveis dummies
a <- dummies::dummy(df$variables$escolaridade_d009, sep = "_",)
df = df[ ,c(escolaridade_d009)]
a = df[ ,c("escolaridade_d009")]
a_dummies <- dummies::dummy(a$variables$escolaridade_d009, sep = "_",)
a$variables <- cbind(a$variables, a_dummies)
View(a$variables)
a$variables[, -1]
a$variables[, 1]
a$variables[, -1]
a$variables <- a$variables[, -1]
View(a$variables)
a = df[ ,c("escolaridade_d009")]
a_dummies <- dummies::dummy(a$variables$escolaridade_d009, sep = "_",)
a$variables <- cbind(a$variables, a_dummies)
a$variables <- a$variables[, -1]
dummies <- dummies::dummy(df$variables$diagnostico_diabetes_q030, sep = "_",)
View(dummies)
a$variables <- cbind(a$variables, dummies$diagnostico_diabetes_q030_1)
dummies <- data.table(dummies::dummy(df$variables$diagnostico_diabetes_q030, sep = "_",))
dummies <- as.data.frame(dummies::dummy(df$variables$diagnostico_diabetes_q030, sep = "_",))
dummies <- as.data.frame(dummies)
View(dummies)
dummies <- dummies::dummy(df$variables$diagnostico_diabetes_q030, sep = "_",)
dummies <- as.data.frame(dummies)
a$variables$diagnostico_diabetes <- dummies$diagnostico_diabetes_q030_1
View(a$variables)
names(a$variable)
gl1 <- survey::svyglm(diagnostico_diabetes ~ escolaridade_d009_0, escolaridade_d009_1, escolaridade_d009_2,   escolaridade_d009_3, escolaridade_d009_4, escolaridade_d009_5 , escolaridade_d009_6, escolaridade_d009_7, escolaridade_d009_8, escolaridade_d009_9, escolaridade_d009_10, escolaridade_d009_11, escolaridade_d009_12, design=a)
gl1 <- survey::svyglm(diagnostico_diabetes ~ escolaridade_d009_0 + escolaridade_d009_1 + escolaridade_d009_2 +   escolaridade_d009_3 + escolaridade_d009_4 + escolaridade_d009_5 + escolaridade_d009_6 + escolaridade_d009_7 + escolaridade_d009_8 + escolaridade_d009_9 + escolaridade_d009_10 + escolaridade_d009_11 + escolaridade_d009_12, design=a)
View(gl1)
knitr::opts_chunk$set(echo = TRUE)
library(srvyr)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(knitr)
library(tidyr)
library(dummies)
library(mlr)
library(caret)
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
print(i)
for (i in pop_esc$d009){
print(i)
}
View(pop_esc)
diab_esc[diab_esc$q030 == " ", ]
diab_esc$porc = 0
diab_esc[diab_esc$q030 == " " & diab_esc$d009 == " ", ]
diab_esc[diab_esc$q030 == " ", ]
diab_esc[diab_esc$q030 == " " & diab_esc$d009 == "", ]
diab_esc[diab_esc$q030 == " " & diab_esc$d009 == "  ", ]
View(diab_esc)
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("freq")] / pop_esc[pop_esc$d009 == i, "freq"]
pop_esc[pop_esc$d009 == "  ", "freq"]
pop_esc[pop_esc$d009 == "  ",]$freq
for (i in pop_esc$d009){
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == "  ",]$freq
}
for (i in pop_esc$d009){
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
diab_esc = diab_esc[diab_esc$q030 == "1", ]
p <-ggplot(data=diab_esc, aes(x=q030, y=porc * 100, fill = q030)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
p <-ggplot(data=diab_esc, aes(x=q030, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
knitr::opts_chunk$set(echo = TRUE)
library(srvyr)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(knitr)
library(tidyr)
library(dummies)
library(mlr)
library(caret)
View(pop_esc)
# q030 variável de diagnostico de diabetes
tir <- survey::svytable(~ q030, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.df$q030 <- c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
tir.df$Freq <- tir.df$Freq / sum(tir.df$Freq)
p <-ggplot(data=tir.df, aes(x=q030, y=Freq*100, fill = q030)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
# q030 variável de diagnostico de diabetes
tir <- survey::svytable(~ q030, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.df$q030 <- c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
tir.df$Freq <- tir.df$Freq / sum(tir.df$Freq)
p <-ggplot(data=tir.df, aes(x=q030, y=Freq*100, fill = q030)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
# c006 variavel do sexo do individuo
diab_sexo <- survey::svytable(~ q030 + c006, pns_design_srvyr)
diab_sexo.df <- as.data.frame(diab_sexo)
diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")] <- diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")]/sum(diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")] )
diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")] <- diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")]/sum(diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")] )
diab_sexo.df$q030 <-  c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético", "Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
p1 <-ggplot(data=diab_sexo.df, aes(x=q030, y=Freq*100 ,fill=c006)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), position=position_dodge(width=0.9), vjust=-0.5, color="black", size=3.5)+
theme_minimal()+
ggtitle("Porcentagem diabetes em relação ao sexo") +
xlab("Categoria") + ylab("Porcentagem %")
p1
fxetaria_diab.df = as.data.frame(survey::svytable(~fxetaria + q030, pns_design_srvyr))
grp <- group_by(fxetaria_diab.df, fxetaria) %>% summarise(freq = sum(Freq))
fxetaria_diab.df <- fxetaria_diab.df[fxetaria_diab.df$q030 == "1",]
fxetaria_diab.df$Freq <- fxetaria_diab.df$Freq/grp$freq
fxetaria_diab.df <- fxetaria_diab.df[-2]
p <- ggplot(data=fxetaria_diab.df, aes(x=fxetaria, y=Freq * 100, fill = fxetaria)) +
geom_bar( stat = "identity",  position = "dodge")+  geom_text(aes(label=round(Freq*100, digits = 1)), position=position_dodge(width=0.9), vjust=-0.5, color="black", size=3.5)
p
freq_diab <- survey::svytable(~ q030 + freqativ + fxetaria , pns_design_srvyr)
freq_diab.df <- as.data.frame(freq_diab)
freq_diab.df <- freq_diab.df[freq_diab.df$q030 == '1',]
freq_diab.df$Freq <- freq_diab.df$Freq/sum(freq_diab.df$Freq)
g <- ggplot(data = freq_diab.df) +
geom_bar(aes(x = freqativ, y = Freq, fill=fxetaria ), stat = "identity") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica x Diabeticos")
g
dist_populacao <- as.data.frame(survey::svytable(~region + v0026, pns_design_srvyr ))
pop_aux1 <- dist_populacao[dist_populacao$v0026 == 1,]
colnames(pop_aux1) <- c("Regiao", "Urbano", "Freq_Urbano")
pop_aux2 <- dist_populacao[dist_populacao$v0026 == 2,]
colnames(pop_aux2) <- c("Regiao", "Rural", "Freq_Rural")
dist_populacao <- cbind(pop_aux1,pop_aux2[, c("Rural", "Freq_Rural")])
dist_populacao$total <- dist_populacao$Freq_Urbano + dist_populacao$Freq_Rural
dist_populacao[,c("Regiao", "Freq_Urbano", "Freq_Rural")]
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- survey::svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026 = as.character(diab_estados.df$v0026)
diab_estados.df$v0026[diab_estados.df$v0026 == 1]  = "1 - Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == 2]  = "2 - Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq/1000, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq/1000, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- as.data.frame(survey::svytable(~ v0001 + q030 , pns_design_srvyr))
qtd_estados = aggregate(diab_estados$Freq, by=list(Category=diab_estados$v0001), FUN=sum)
diab_estados <- diab_estados[diab_estados$q030 == 1,]
diab_estados$Porcent <- diab_estados$Freq / qtd_estados$x
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
porc_est <- as.data.frame(teste)
porc_est$Porcent <- diab_estados$Porcent
##
##uf_map <- get_brmap("State") %>%
#  inner_join(porc_est, c("nome" = "teste"))
#uf_map %>%
#  ggplot(aes(fill = Porcent)) +
#  geom_sf() +
#  scale_fill_continuous(low = "lightblue", high = "darkblue")
plot_brmap(get_brmap("State"), data_to_join = porc_est, join_by = c("nome" = "teste"),
var = "Porcent") + scale_fill_continuous(low = "lightblue", high = "darkblue")
survey::svyhist(~as.numeric(q031), subset(pns_design_srvyr, q030==1))
dens <- survey::svysmooth(~as.numeric(q031), subset(pns_design_srvyr, (q030==1) & (q030!=" ")))
lines(dens,col="blue",lwd=2)
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
diab_esc = diab_esc[diab_esc$q030 == "1", ]
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
print(sum(pop_esc$freq))
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ] , pop_esc[pop_esc$d009 == i,]$freq )
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
print(sum(pop_esc$freq))
diab_esc = diab_esc[diab_esc$q030 == "1", ]
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
View(diab_esc)
print(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq , pop_esc[pop_esc$d009 == i,]$freq )
for (i in pop_esc$d009){
print(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq , pop_esc[pop_esc$d009 == i,]$freq )
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq , pop_esc[pop_esc$d009 == i,]$freq )
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  )
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
print(sum(pop_esc$freq))
diab_esc = diab_esc[diab_esc$q030 == "1", ]
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq)
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
print(paste([diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq])
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(paste([diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq])
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(paste([diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq]))
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(paste(c[diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq]))
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(paste(c(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq)))
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
print(sum(pop_esc$freq))
diab_esc = diab_esc[diab_esc$q030 == "1", ]
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
View(diab_esc)
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
diab_esc[diab_esc$d009 == "01"]
diab_esc[diab_esc$d009 == "01",]
sum(diab_esc[diab_esc$d009 == "01",]$Freq)
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(paste(c(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq)))
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
print(sum(pop_esc$freq))
diab_esc = diab_esc[diab_esc$q030 == "1", ]
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
sum(pop_esc$freq)
sum(diab_esc$Freq)
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(paste(c(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq)))
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
print(sum(diab_esc$Freq))
print(sum(pop_esc$freq))
diab_esc = diab_esc[diab_esc$q030 == "1", ]
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
for (i in pop_esc$d009){
print(paste(c(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq)))
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
diab_esc = diab_esc[diab_esc$q030 == "1", ]
print(sum(diab_esc$Freq))
print(sum(pop_esc$freq))
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
diab_esc <- survey::svytable(~ q030 + d009, pns_design_srvyr)
diab_esc <- as.data.frame(diab_esc)
diab_esc$porc = 0
pop_esc = group_by(diab_esc, d009) %>% summarise(freq = sum(Freq))
diab_esc = diab_esc[diab_esc$q030 == "1", ]
for (i in pop_esc$d009){
print(paste(c(diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq  ,  pop_esc[pop_esc$d009 == i,]$freq)))
diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, c("porc")] = diab_esc[diab_esc$q030 == "1" & diab_esc$d009 == i, ]$Freq / pop_esc[pop_esc$d009 == i,]$freq
}
print(sum(diab_esc$Freq))
print(sum(pop_esc$freq))
p <-ggplot(data=diab_esc, aes(x=d009, y=porc * 100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(porc*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
View(dummies)
df$variables$exames_glicemia_q029 = NULL
df_dummies = df[ ,c("escolaridade_d009")]
# esc_dummies <- dummies::dummy(df$variables$escolaridade_d009, sep = "_",)
# df_dummies$variables <- cbind(df_dummies$variables, esc_dummies)
# df_dummies$variables <- df_dummies$variables[, -1]
df_factor = df$variables %>% mutate_if(is.numeric, as.character)
df_factor$peso_w00103 <- as.numeric(df_factor$peso_w00103)
df_factor$altura_w00203 <- NULL
df_factor$idade <- NULL
df_factor$imc <- NULL
df_factor$peso_w00103 <- NULL
df_factor = df_factor %>% mutate_if(is.character, as.factor)
dummies_df <- mlr::createDummyFeatures(df_factor)
View(dummies_df)
gl1 <- survey::svyglm(diagnostico_diabetes ~ escolaridade_d009_0 + escolaridade_d009_1 + escolaridade_d009_2 +   escolaridade_d009_3 + escolaridade_d009_4 + escolaridade_d009_5 + escolaridade_d009_6 + escolaridade_d009_7 + escolaridade_d009_8 + escolaridade_d009_9 + escolaridade_d009_10 + escolaridade_d009_11 + escolaridade_d009_12, design=a)
survey::svyglm?
c
?survey::svyglm
View(gl1)
View(gl1$weights)
View(gl1$coefficients)
View(dummies_df)
library(srvyr)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(knitr)
library(tidyr)
library(dummies)
library(mlr)
library(caret)
