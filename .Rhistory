knitr::opts_chunk$set(echo = TRUE)
options( survey.lonely.psu = "adjust" )
options( survey.lonely.psu = "adjust" )
library(survey)
pns_design <- readRDS(file.path(path.expand( "~" ) ,
"../../databases/PNS/Dados/",
"2013 long questionnaire survey design.rds" ))
options( survey.lonely.psu = "adjust" )
library(survey)
pns_design <- readRDS(file.path(path.expand( "~" ) ,
"../../../databases/PNS/Dados/",
"2013 long questionnaire survey design.rds" ))
file.path(path.expand( "~" ) ,
"../../databases/PNS/Dados/")
pns_design <- readRDS(file.path(path.expand( "~" ) ,
"projetinho/projetinho/databases/PNS/Dados/",
"2013 long questionnaire survey design.rds" ))
file.path(path.expand( "~" ) ,"projetinho/projetinho/databases/PNS/Dados/")
pns_design <- readRDS(file.path(path.expand( "~" ) ,
"databases/PNS/Dados/",
"2013 long questionnaire survey design.rds" ))
View(pns_design)
library(srvyr)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(knitr)
library(tidyr)
pns_design_srvyr <- as_survey_design(pns_design)
View(pns_design_srvyr)
pns_design_srvyr <- pns_design_srvyr %>% mutate(imc = w00103/(w00203/100*w00203/100))
View(pns_design_srvyr)
pns_design_srvyr <- pns_design_srvyr %>%
mutate(imcclass = case_when(imc < 17.0 ~ "1",
imc >= 17.0 & imc < 18.5 ~ "2",
imc >= 18.5 & imc < 25.0 ~ "3",
imc >= 25.0 & imc < 30.0 ~ "4",
imc >= 30.0 & imc < 35.0 ~ "5",
imc >= 35.0 & imc < 40.0 ~ "6",
imc >= 40.0 ~ "7"
))
dstrata <- pns_design_srvyr %>% as_survey_design(strata = stype, weights = pw)
View(dstrata)
# Criando uma variavel idade numerica
pns_design_srvyr <- pns_design_srvyr %>% mutate(idade = as.numeric(c008))
pns_design_srvyr <- pns_design_srvyr %>%
mutate(fxetaria = case_when(idade <   5.0 ~ "2",
idade >=  5.0 & idade < 10.0 ~ "7",
idade >= 10.0 & idade < 15.0 ~ "12",
idade >= 15.0 & idade < 20.0 ~ "18",
idade >= 20.0 & idade < 25.0 ~ "22",
idade >= 25.0 & idade < 40.0 ~ "32",
idade >= 40.0 & idade < 60.0 ~ "50",
idade >= 60.0 ~ "60"))
str(pns_design_srvyr)
pns_design_srvyr$variables
a = pns_design_srvyr$variables
View(a)
View(pns_design_srvyr$variables)
View(pns_design_srvyr)
View(pns_design_srvyr$cluster)
View(pns_design_srvyr$strata)
View(pns_design_srvyr$has.strata)
View(pns_design_srvyr$prob)
View(pns_design_srvyr$call)
View(pns_design_srvyr$postStrata)
View(pns_design_srvyr)
pns_design_srvyr$variables$idade
Valor Original    |      Codificação Original         | Novo Valor    | Codificação Variável `freqativ`
------------------|-----------------------------------|---------------|----------------------------------------
1       |  mais de uma vez por semana       |     5      |  mais de uma vez por semana
2       |  uma vez por semana               |     4      |  uma vez por semana
3       |  de 2 a 3 vezes por mês           |     3      |  de 2 a 3 vezes por mês
4       |  algumas vezes no ano             |     2      |  algumas vezes no ano
5       |  uma vez no ano                   |     1      |    uma vez no ano
6       |   nenhuma vez                     |     0      |     nenhuma vez
pns_design_srvyr <- pns_design_srvyr %>% mutate(freqativ = case_when(m016 == 6 ~ 0, # Nenhuma vez
m016 == 5 ~ 1, # Uma vez/ano
m016 == 4 ~ 2, # Algumas vezes/ano
m016 == 3 ~ 3, # 2-3 vezes/mes
m016 == 2 ~ 4, # Uma vez/semana
m016 == 1 ~ 5, # Mais de uma vez/semana
))
tabela.prop <- prop.table(svytable(~ imcclass + region, pns_design_srvyr))
obesos.perc <- as_tibble(tabela.prop) %>% filter(imcclass >= 4) %>% summarise(tot = sum(n))
View(obesos.perc)
tabela <- svytable(~ imcclass + region, pns_design_srvyr)
tb.df <- as.data.frame(tabela)
tb.spread <- spread(tb.df, region, Freq  )
kable(tb.spread, digits = 3, col.names = c("Classe IMC", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"), caption = "Distribuição da População por Classe de IMC por Regiões do Brasil")
pns_design_srvyr$variables$region
tabela <- svytable(~ imcclass + region, pns_design_srvyr)
tb.df <- as.data.frame(tabela)
tb.spread <- spread(tb.df, region, Freq  )
kable(tb.spread, digits = 3, col.names = c("Classe IMC", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"), caption = "Distribuição da População por Classe de IMC por Regiões do Brasil")
g <- ggplot(data = tb.df) + geom_bar(aes(x = region, y = Freq/1000, fill = imcclass), stat = "identity",  position = "dodge") + labs(x = "Região",y = "Pessoas (x1000)", title = "Distribuição da População por Classe de IMC por Regiões do Brasil", fill = "Classe IMC") +  labs_pubr() + theme_pubr()
g
tabelaimcreg.prop <- prop.table(svytable(~ imcclass + region, pns_design_srvyr))
kable(cbind(tb.spread$imcclass,addmargins(tabelaimcreg.prop*100, 2)), digits = 2, caption = "Proporção de Distribuição da População por Classe de IMC por Regiões do Brasil", col.names = c("Classe IMC", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste", "Total (%)"))
tabela.fxet <- svytable(~ fxetaria + region, pns_design_srvyr)
tbfxet.df <- as.data.frame(tabela.fxet)
tbfxet.spread <- spread(tbfxet.df, region, Freq  )
kable(tbfxet.spread, digits = 3, col.names = c("Faixa Etaria", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"),  caption = "Distribuição da População por Faixa Etária (acima de 18 anos) por Regiões do Brasil")
g <- ggplot(data = tbfxet.df) + geom_bar(aes(x = region, y = Freq/1000, fill = fxetaria), stat = "identity",  position = "dodge") + labs(x = NULL,y = "Pessoas (x1000)", title = "Distribuição da População por Faixa Etária (acima de 18 anos) \npor Regiões do Brasil", fill = "Faixa Etária") +  labs_pubr() + theme_pubr() #+ theme(legend.position = "right")
g
pns_design_srvyr$variables$fxetaria
View(pns_design)
view(pns_design_srvyr$variables[, "W00401"]
pns_design_srvyr$variables[, "W00401"]
pns_design_srvyr$variables[, "W00401"]
pns_design_srvyr$variables["W00401"]
pns_design_srvyr$variables["w00401"]
pns_design_srvyr$variables["z001"]
knitr::opts_chunk$set(echo = TRUE)
# Introdução
## R Markdown
## Leitura e preparação dos dados
#ajustar como os resutados serão mostraos
options( survey.lonely.psu = "adjust" )
library(survey)
#importando a biblioteca.
pns_design <- readRDS(file.path(path.expand( "~" ) ,
"databases/PNS/Dados/",
"2013 long questionnaire survey design.rds" ))
tabela <- svytable(~ imcclass + region, pns_design_srvyr)
tb.df <- as.data.frame(tabela)
tb.spread <- spread(tb.df, region, Freq  )
# Criando uma variavel idade numerica
pns_design_srvyr <- pns_design_srvyr %>% mutate(idade = as.numeric(c008))
knitr::opts_chunk$set(echo = TRUE)
library(srvyr)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(knitr)
library(tidyr)
#adiciona a sintaxe dplyr de manipulação de dados ao pacote survey
pns_design_srvyr <- as_survey_design(pns_design)
tabela <- svytable(~ imcclass + region, pns_design_srvyr)
#adiciona a sintaxe dplyr de manipulação de dados ao pacote survey
pns_design_srvyr <- as_survey_design(pns_design)
# Criando uma variavel idade numerica
pns_design_srvyr <- pns_design_srvyr %>% mutate(idade = as.numeric(c008))
pns_design_srvyr <- pns_design_srvyr %>%
mutate(fxetaria = case_when(idade <   5.0 ~ "2",
idade >=  5.0 & idade < 10.0 ~ "7",
idade >= 10.0 & idade < 15.0 ~ "12",
idade >= 15.0 & idade < 20.0 ~ "18",
idade >= 20.0 & idade < 25.0 ~ "22",
idade >= 25.0 & idade < 40.0 ~ "32",
idade >= 40.0 & idade < 60.0 ~ "50",
idade >= 60.0 ~ "60"))
tabela_idade_regiao <- svytable(~ fxetaria + region, pns_design_srvyr)
tb.df <- as.data.frame(tabela)
tb.spread <- spread(tb.df, region, Freq  )
kable(tb.spread, digits = 3, col.names = c("Classe IMC", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"), caption = "Distribuição da População por Classe de IMC por Regiões do Brasil")
tir <- svytable(~ fxetaria + region, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.spread <- spread(tb.df, region, Freq  )
kable(tb.spread, digits = 3, col.names = c("Classe IMC", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"), caption = "Distribuição da População por Classe de IMC por Regiões do Brasil")
tir <- svytable(~ fxetaria + region, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.spread <- spread(tb.df, region, Freq  )
kable(tb.spread, digits = 3, col.names = c("Faixa Etaria", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"), caption = "Distribuição da População por Classe de IMC por Regiões do Brasil")
view(tir.df)
View(tir.df)
View(tir.spread)
tir <- svytable(~ fxetaria + region, pns_design_srvyr)
tir <- svytable(~ fxetaria + region, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.spread <- spread(tb.df, region, Freq  )
kable(tir.spread, digits = 3, col.names = c("Faixa Etaria", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"), caption = "Distribuição da População por Classe de IMC por Regiões do Brasil")
View(tir.df)
g <- ggplot(data = tir.df) + geom_bar(aes(x = region, y = Freq/1000, fill = fxetaria), stat = "identity",  position = "dodge") + labs(x = "Região",y = "Pessoas (x1000)", title = "Distribuição da População por Classe de IMC por Regiões do Brasil", fill = "Classe IMC") +  labs_pubr() + theme_pubr()
g
g <- ggplot(data = tir.df) + geom_bar(aes(x = region, y = Freq/1000, fill = fxetaria), stat = "identity",  position = "dodge") + labs(x = "Região",y = "Pessoas (x1000)", title = "Distribuição da População por Faixa Etaria por Regiões do Brasil", fill = "Faixa Etaria") +  labs_pubr() + theme_pubr()
g
tir <- svytable(~ fxetaria + region, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.spread <- spread(tir.df, region, Freq  )
kable(tir.spread, digits = 3, col.names = c("Faixa Etaria", "Norte","Nordeste","Sudeste","Sul","Centro-Oeste"), caption = "Distribuição da População por Classe de IMC por Regiões do Brasil")
g <- ggplot(data = tir.df) + geom_bar(aes(x = region, y = Freq/1000, fill = fxetaria), stat = "identity",  position = "dodge") + labs(x = "Região",y = "Pessoas (x1000)", title = "Distribuição da População por Faixa Etaria por Regiões do Brasil", fill = "Faixa Etaria") +  labs_pubr() + theme_pubr()
g
tff <- svytable(~ freqativ + fxetaria, pns_design_srvyr)
pns_design_srvyr <- pns_design_srvyr %>% mutate(freqativ = case_when(m016 == 6 ~ 0, # Nenhuma vez
m016 == 5 ~ 1, # Uma vez/ano
m016 == 4 ~ 2, # Algumas vezes/ano
m016 == 3 ~ 3, # 2-3 vezes/mes
m016 == 2 ~ 4, # Uma vez/semana
m016 == 1 ~ 5, # Mais de uma vez/semana
))
tff <- svytable(~ freqativ + fxetaria, pns_design_srvyr)
tff.df <- as.data.frame(tir)
tff.spread <- spread(tff.df, region, Freq  )
g <- ggplot(data = tff.df) + geom_bar(aes(x = fxetaria, y = Freq/1000, fill = freqativ), stat = "identity",  position = "dodge") + labs(x = "Faixa Etaria",y = "Pessoas (x1000)", title = "Distribuição da População por Frequencia de Ativ Fissica por Faixa Etaria", fill = "Faixa Etaria") +  labs_pubr() + theme_pubr()
g
View(tff.df)
tff <- svytable(~ freqativ + fxetaria, pns_design_srvyr)
tff.df <- as.data.frame(tff)
tff.spread <- spread(tff.df, fxetaria, Freq  )
g <- ggplot(data = tff.df) + geom_bar(aes(x = fxetaria, y = Freq/1000, fill = freqativ), stat = "identity",  position = "dodge") + labs(x = "Faixa Etaria",y = "Pessoas (x1000)", title = "Distribuição da População por Frequencia de Ativ Fissica por Faixa Etaria", fill = "Faixa Etaria") +  labs_pubr() + theme_pubr()
g
tff <- svytable(~ freqativ + fxetaria, pns_design_srvyr)
tff.df <- as.data.frame(tff)
tff.spread <- spread(tff.df, fxetaria, Freq  )
g <- ggplot(data = tff.df) + geom_bar(aes(x = fxetaria, y = Freq/1000, fill = freqativ), stat = "identity",  position = "dodge") + labs(x = "Faixa Etaria",y = "Pessoas (x1000)", title = "Distribuição da População por Frequencia de Ativ Fisica por Faixa Etaria", fill = "Freq Ativ Fisica") +  labs_pubr() + theme_pubr()
g
