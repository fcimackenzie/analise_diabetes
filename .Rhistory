geom_bar(aes(x = freqativ, y = Freq ), stat = "identity",  position = "dodge") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica por Faixa Diabetes") +
scale_fill_manual(values=c("#999999", "#E69F00"))
g
freq_diab <- svytable(~ q030 + freqativ , pns_design_srvyr)
freq_diab.df <- as.data.frame(freq_diab)
freq_diab.df <- freq_diab.df[freq_diab.df$q030 == '1',]
freq_diab.df$Freq <- freq_diab.df$Freq/sum(freq_diab.df$Freq)
g <- ggplot(data = freq_diab.df,  aes(x = freqativ, y = Freq, fill=freqativ )) +
geom_bar(stat = "identity",  position = "dodge") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica por Faixa Diabetes") +
scale_fill_manual(values=c("#999999", "#E69F00"))
g
freq_diab <- svytable(~ q030 + freqativ , pns_design_srvyr)
freq_diab.df <- as.data.frame(freq_diab)
freq_diab.df <- freq_diab.df[freq_diab.df$q030 == '1',]
freq_diab.df$Freq <- freq_diab.df$Freq/sum(freq_diab.df$Freq)
g <- ggplot(data = freq_diab.df) +
geom_bar(aes(x = freqativ, y = Freq, fill=freqativ ), stat = "identity",  position = "dodge") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica por Faixa Diabetes") +
scale_fill_manual(values=c("#999999", "#E69F00"))
g
freq_diab <- svytable(~ q030 + freqativ , pns_design_srvyr)
freq_diab.df <- as.data.frame(freq_diab)
freq_diab.df <- freq_diab.df[freq_diab.df$q030 == '1',]
freq_diab.df$Freq <- freq_diab.df$Freq/sum(freq_diab.df$Freq)
g <- ggplot(data = freq_diab.df) +
geom_bar(aes(x = freqativ, y = Freq, fill=freqativ ), stat = "identity",  position = "dodge") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica por Faixa Diabetes")
g
fxetaria_diab.df = as.data.frame(svytable(~fxetaria + q030, pns_design_srvyr))
grp <- group_by(fxetaria_diab.df, fxetaria) %>% summarise(freq = sum(Freq))
fxetaria_diab.df <- fxetaria_diab.df[fxetaria_diab.df$q030 == "1",]
fxetaria_diab.df$Freq <- fxetaria_diab.df$Freq/grp$freq
fxetaria_diab.df <- fxetaria_diab.df[-2]
p <- ggplot(data=fxetaria_diab.df, aes(x=fxetaria, y=Freq * 100, fill = fxetaria)) +               geom_text(aes(label=round(Freq*100, digits = 1)), position=position_dodge(width=0.9), vjust=-0.5, color="black", size=3.5)
p
fxetaria_diab.df = as.data.frame(svytable(~fxetaria + q030, pns_design_srvyr))
grp <- group_by(fxetaria_diab.df, fxetaria) %>% summarise(freq = sum(Freq))
fxetaria_diab.df <- fxetaria_diab.df[fxetaria_diab.df$q030 == "1",]
fxetaria_diab.df$Freq <- fxetaria_diab.df$Freq/grp$freq
fxetaria_diab.df <- fxetaria_diab.df[-2]
p <- ggplot(data=fxetaria_diab.df, aes(x=fxetaria, y=Freq * 100, fill = fxetaria)) +
geom_bar( stat = "identity",  position = "dodge")+  geom_text(aes(label=round(Freq*100, digits = 1)), position=position_dodge(width=0.9), vjust=-0.5, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity", fill="steelblue") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
theme_minimal()
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100,)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=0.5, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=1, color="black", size=3.5)
p
View(diab_estados.df)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados$v0026[diab_estados$v0026 == "1"]  = "Urbano"
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026[diab_estados.df$v0026 == "1"]  = "Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == "2"]  = "Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026[diab_estados.df$v0026 == 1]  = "Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == 2]  = "Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026[diab_estados.df$v0026 == 1]  = "Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == 2]  = "Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026 = as.character(diab_estados.df$v0026)
diab_estados.df$v0026[diab_estados.df$v0026 == 1]  = "Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == 2]  = "Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026 = as.character(diab_estados.df$v0026)
diab_estados.df$v0026[diab_estados.df$v0026 == 1]  = "1 - Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == 2]  = "2 - Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
install.packages("brazilmaps")
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#region
diab_estados <- svytable(~ q030 + region + v0026, pns_design_srvyr )
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
diab_estados.df$v0026 = as.character(diab_estados.df$v0026)
diab_estados.df$v0026[diab_estados.df$v0026 == 1]  = "1 - Urbano"
diab_estados.df$v0026[diab_estados.df$v0026 == 2]  = "2 - Rural"
p <-ggplot(data=diab_estados.df, aes(x=region, y=Freq*100, fill=v0026)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=1, color="black", size=3.5)
p
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- (diab_estados.df$Freq / sum(diab_estados.df$Freq))*100
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
teste <- as.data.frame(teste)
teste$Freq <- diab_estados.df$Freq
uf_map <- get_brmap("State") %>%
inner_join(teste, c("nome" = "teste"))
uf_map %>%
ggplot() +
geom_sf(aes(fill = Freq/100))+
scale_fill_continuous(low = "lightblue", high = "darkblue")
#estados<-readOGR("data/estados_br", "UFEBRASIL", encoding = "utf8")
#diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#diab_estados.df <- as.data.frame(diab_estados)
#diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- (diab_estados.df$Freq / sum(diab_estados.df$Freq))*100
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
teste <- as.data.frame(teste)
teste$Freq <- diab_estados.df$Freq
uf_map <- get_brmap("State") %>%
inner_join(teste, c("nome" = "teste"))
uf_map %>%
ggplot() +
geom_sf(aes(fill = Freq/100))+
scale_fill_continuous(low = "lightblue", high = "darkblue")
#estados<-readOGR("data/estados_br", "UFEBRASIL", encoding = "utf8")
#diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#diab_estados.df <- as.data.frame(diab_estados)
#diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- (diab_estados.df$Freq / sum(diab_estados.df$Freq))*100
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
teste <- as.data.frame(teste)
teste$Freq <- diab_estados.df$Freq
uf_map <- get_brmap("State") %>%
inner_join(teste, c("nome" = "teste"))
uf_map %>%
ggplot() +
geom_sf(aes(fill = Freq/100))+
scale_fill_continuous(low = "lightblue", high = "darkblue")
#estados<-readOGR("data/estados_br", "UFEBRASIL", encoding = "utf8")
#diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#diab_estados.df <- as.data.frame(diab_estados)
#diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- (diab_estados.df$Freq / sum(diab_estados.df$Freq))*100
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
teste <- as.data.frame(teste)
teste$Freq <- diab_estados.df$Freq
uf_map <- get_brmap("State") %>%
inner_join(teste, c("nome" = "teste"))
uf_map %>%
ggplot() +
geom_sf(aes(fill = Freq))+
scale_fill_continuous(low = "lightblue", high = "darkblue")
#estados<-readOGR("data/estados_br", "UFEBRASIL", encoding = "utf8")
#diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#diab_estados.df <- as.data.frame(diab_estados)
#diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- (diab_estados.df$Freq / sum(diab_estados.df$Freq))
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
teste <- as.data.frame(teste)
teste$Freq <- diab_estados.df$Freq
uf_map <- get_brmap("State") %>%
inner_join(teste, c("nome" = "teste"))
uf_map %>%
ggplot() +
geom_sf(aes(fill = Freq))+
scale_fill_continuous(low = "lightblue", high = "darkblue")
#estados<-readOGR("data/estados_br", "UFEBRASIL", encoding = "utf8")
#diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#diab_estados.df <- as.data.frame(diab_estados)
#diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
# q030 variável se diagnostico de diabetes
tir <- svytable(~ q030, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.df$q030 <- c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
tir.df$Freq <- tir.df$Freq / sum(tir.df$Freq)
p <-ggplot(data=tir.df, aes(x=q030, y=Freq*100)) +
geom_bar(stat="identity",fill = q030) +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
View(tir.df)
# q030 variável se diagnostico de diabetes
tir <- svytable(~ q030, pns_design_srvyr)
tir.df <- as.data.frame(tir)
tir.df$q030 <- c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
tir.df$Freq <- tir.df$Freq / sum(tir.df$Freq)
p <-ggplot(data=tir.df, aes(x=q030, y=Freq*100, fill = q030)) +
geom_bar(stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), vjust=-0.5, color="black", size=3.5)+
labs_pubr() + theme_pubr()
p
# c006 variavel do sexo do individuo
diab_sexo <- survey::svytable(~ q030 + c006, pns_design_srvyr)
diab_sexo.df <- as.data.frame(diab_sexo)
diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")] <- diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")]/sum(diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")] )
diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")] <- diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")]/sum(diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")] )
diab_sexo.df$q030 <-  c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético", "Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
p1 <-ggplot(data=diab_sexo.df, aes(x=q030, y=Freq*100 ,fill=c006)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), position=position_dodge(width=0.9), vjust=-0.5, color="black", size=3.5)+
theme_minimal()+
ggtitle("Porcentagem diabetes por sexo") +
xlab("Categoria") + ylab("Porcentagem %")
p1
knitr::opts_chunk$set(echo = TRUE)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
library(srvyr)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(knitr)
library(tidyr)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
knitr::opts_chunk$set(echo = TRUE)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- survey::svytable(~ v0001 + q030 , pns_design_srvyr)
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- (diab_estados.df$Freq / sum(diab_estados.df$Freq))
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
teste <- as.data.frame(teste)
teste$Freq <- diab_estados.df$Freq
uf_map <- get_brmap("State") %>%
inner_join(teste, c("nome" = "teste"))
uf_map %>%
ggplot() +
geom_sf(aes(fill = Freq))+
scale_fill_continuous(low = "lightblue", high = "darkblue")
#estados<-readOGR("data/estados_br", "UFEBRASIL", encoding = "utf8")
#diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#diab_estados.df <- as.data.frame(diab_estados)
#diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
# c006 variavel do sexo do individuo
diab_sexo <- survey::svytable(~ q030 + c006, pns_design_srvyr)
diab_sexo.df <- as.data.frame(diab_sexo)
diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")] <- diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")]/sum(diab_sexo.df[diab_sexo.df$c006 == "masculino",c("Freq")] )
diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")] <- diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")]/sum(diab_sexo.df[diab_sexo.df$c006 == "feminino",c("Freq")] )
diab_sexo.df$q030 <-  c("Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético", "Não Aplicável", "Diabético", "Diabete Gestacional", "Não Diabético")
p1 <-ggplot(data=diab_sexo.df, aes(x=q030, y=Freq*100 ,fill=c006)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Freq*100, digits = 1)), position=position_dodge(width=0.9), vjust=-0.5, color="black", size=3.5)+
theme_minimal()+
ggtitle("Porcentagem diabetes em relação ao sexo") +
xlab("Categoria") + ylab("Porcentagem %")
p1
freq_diab <- svytable(~ q030 + freqativ + fxetaria , pns_design_srvyr)
freq_diab <- survey::svytable(~ q030 + freqativ + fxetaria , pns_design_srvyr)
freq_diab.df <- as.data.frame(freq_diab)
freq_diab.df <- freq_diab.df[freq_diab.df$q030 == '1',]
freq_diab.df$Freq <- freq_diab.df$Freq/sum(freq_diab.df$Freq)
g <- ggplot(data = freq_diab.df) +
geom_bar(aes(x = freqativ, y = Freq, fill=freqativ ), stat = "identity",  position = "dodge") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica por Faixa Diabetes")
g
freq_diab <- survey::svytable(~ q030 + freqativ + fxetaria , pns_design_srvyr)
freq_diab.df <- as.data.frame(freq_diab)
freq_diab.df <- freq_diab.df[freq_diab.df$q030 == '1',]
freq_diab.df$Freq <- freq_diab.df$Freq/sum(freq_diab.df$Freq)
g <- ggplot(data = freq_diab.df) +
geom_bar(aes(x = freqativ, y = Freq, fill=fxetaria ), stat = "identity",  position = "dodge") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica por Faixa Diabetes")
g
freq_diab <- survey::svytable(~ q030 + freqativ + fxetaria , pns_design_srvyr)
freq_diab.df <- as.data.frame(freq_diab)
freq_diab.df <- freq_diab.df[freq_diab.df$q030 == '1',]
freq_diab.df$Freq <- freq_diab.df$Freq/sum(freq_diab.df$Freq)
g <- ggplot(data = freq_diab.df) +
geom_bar(aes(x = freqativ, y = Freq, fill=fxetaria ), stat = "identity") +
labs(x = "Freq Ativ Fisica",y = "Pessoas %", title = "Frequencia de Ativ Fisica x Diabeticos")
g
#* `Q030`	- Algum médico já lhe deu o diagnóstico de diabetes?
#   + `1` - Sim
#   + V0001 - Unidade da Federação
library(brazilmaps)
mapa <- get_brmap("State")
diab_estados <- survey::svytable(~ v0001 + q030 , pns_design_srvyr)
diab_estados.df <- as.data.frame(diab_estados)
diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
diab_estados.df$Freq <- (diab_estados.df$Freq / sum(diab_estados.df$Freq))
teste <- toupper(c("Rondônia","Acre","Amazonas","Roraima","Pará","Amapá","Tocantins","Maranhão","Piauí","Ceará",
"Rio Grande do Norte","Paraíba","Pernambuco","Alagoas","Sergipe","Bahia","Minas Gerais","Espírito Santo","Rio de Janeiro","São Paulo","Paraná","Santa Catarina","Rio Grande do Sul","Mato Grosso do Sul",
"Mato Grosso","Goiás","Distrito Federal"))
teste <- as.data.frame(teste)
teste$Freq <- diab_estados.df$Freq
uf_map <- get_brmap("State") %>%
inner_join(teste, c("nome" = "teste"))
uf_map %>%
ggplot() +
geom_sf(aes(fill = Freq))+
scale_fill_continuous(low = "lightblue", high = "darkblue")
#estados<-readOGR("data/estados_br", "UFEBRASIL", encoding = "utf8")
#diab_estados <- svytable(~ v0001 + q030 , pns_design_srvyr)
#diab_estados.df <- as.data.frame(diab_estados)
#diab_estados.df <- diab_estados.df[diab_estados.df$q030 == '1',]
#diab_estados.df$Freq <- diab_estados.df$Freq / sum(diab_estados.df$Freq)
